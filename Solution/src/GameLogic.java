//
//
//  Generated by StarUML(tm) Java Add-In
//
//  @ Project : Untitled
//  @ File Name : GameLogic.java
//  @ Date : 2019.03.20.
//  @ Author : 
//
//


import java.util.ArrayList;

/**
 * Az osztaly amely a jatek motorjat kepezi, inicializalja a jatekot,
 * illetve az allatok lepteteset es a targyak uzemelteteset vegzi.
 * @author Konczos
 */


public class GameLogic{
    /**
     * A jatekos megszerzett pointjait tarolo int.
     */
    private int Points;
    /**
     * A program futasat jelzo boolean.
     */
    private boolean running = false;
    /**
     * A mapen levo pandakat tarolo lista.
     */
    private ArrayList<Animal> AnimalsOnTheMap;
    /**
     * A mapen levo speciális funkcioalitassal ellatott targyakat tarolo lista.
     */
    private ArrayList<Item> ItemsOnTheMap;
    /**
     * A mapen levo szekrenyeket tarolo lista.
     */
    private ArrayList<EntryWardrobe> TilesOnMap;

    /**
     * A fuggveny a jatek inicializalasat vegzi.
     */
    public void initGame(){
        System.out.println(">   initGame()");
        System.out.println("<   initGame()");
        running = true;
    }

    /**
     * A jatek idoziteset elvegzo fuggveny.
     */
    public void game() {
        System.out.println(">   game()");
        long lastTime = System.nanoTime(); //utolsó mentett rendszeridő nanoszekundumban
        final double amountOfTicks = 2D; //hány ticket akarunk másodpercenként --> 2 tick másodpercenként
        double nanoSec = 1000000000 / amountOfTicks; //hány nanoszekudumonként kell tickelni
        double delta = 0;

        while(running){
            long now =  System.nanoTime(); //aktuális rendszeridő nanoszekundumban
            delta += (now - lastTime) / nanoSec;
            lastTime = now;
            if (delta >= 1){
                tick(); //az állatok és tárgyak léptetése/üzemeltetése
                delta--;
            }

        }
        System.out.println("<   game()");
    }

    /**
     * A fuggveny szamolja a jatekos altal a kijaraton atjuttatott pandakat
     * es ez alapjan noveli a pontszamlalot.
     */
    public void addPoints(int p) {
        System.out.println(">   addPoints(int p)");
        Points += (p * 50);
        System.out.println("<   addPoints(int p)");
    }

    /**
     * A fuggveny befejezi a jatekot es kilep belole.
     */
    public void endGame() {
        System.out.println(">   endGame()");
        if(AnimalsOnTheMap.isEmpty()) {
            System.out.println("You caugth all pandas!");
            System.out.println("You caugt:" + Points + "pandas!");
        }else{
            System.out.println("You Lost!");
        }
        System.out.println("<   endGame()");
        System.exit(0);
    }

    /**
     * A fuggveny az allatok lepteteset es targyak üzemeltetest latja el.
     */
    public void tick() {
        System.out.println(">   tick()");
        for(int i = 0; i != AnimalsOnTheMap.size(); ++i){
        AnimalsOnTheMap.get(i).move();
        }

        for(int j = 0; j != ItemsOnTheMap.size(); ++j){
        ItemsOnTheMap.get(j).countDown();
        }
        System.out.println("<   tick()");
    }

    /**
     * Eltavolitja a halott allatot.
     */
    public void remove(Animal a){
        System.out.println(">   remove(Animal a)");
        AnimalsOnTheMap.remove(a);
        a = null;
        System.out.println("<   remove(Animal a)");
    }

    public void addAnimal(Animal a) {
        System.out.println(">   addAnimal(Animal a)");
        AnimalsOnTheMap.add(a);
        System.out.println("<   addAnimal(Animal a)");
    }

    public GameLogic() {
        Points = 0;
        AnimalsOnTheMap = new ArrayList<>();
        TilesOnMap = new ArrayList<>();
        ItemsOnTheMap = new ArrayList<>();
    }

}
